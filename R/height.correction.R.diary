>(fset 'f10
   [?\C-a ?\C-f ?\C-f ?\C-  ?\C-e ?\M-w ?\C-f ?\C-x ?o ?\M-> ?\C-y ?\C-x ?q return ?\C-x ?o])

M-x R 
Note: C-c C-v is for help or help.search('topic')

> Sys.setenv("DISPLAY"=":0")
> x11()
> sanity<-par()
> options(width=120)
> par(sanity)
> ps.options.send(colors=xgetrgb('lines'))

> ######################################################################

> a<-0.032
> k<-0.4
> g<-9.81
> z<-10
> gp<-g/(a*k^2)
> z0<-2^(-(30:0))
> h<-z/z0
> beta<-(log(h))^2/h
> vz0<-sqrt(beta*gp*z)
> par(pty='s')
> z0fit<-lsfit(log(vz0[1:24]),log(z0[1:24]))
> plot(log(vz0),log(z0))
> abline(z0fit) 
> z0fit$coef
 Intercept        X 
 -12.88874 2.327908
> ! ghostview ps.out.0001.ps &

> hfit<-lsfit(log(sqrt(beta[1:24])),log(1/h[1:24]))
> plot(log(sqrt(beta)),log(1/h))
> abline(hfit)
> hfit$coef
 Intercept        X 
  -3.71405 2.327908

> plot(log(beta),log(h))
> hbfit<-lsfit(log(beta[1:24]),log(h[1:24]))
> abline(hbfit)
> hbfit$coef
 Intercept         X 
   3.71405 -1.163954

> z0j<-1.54e-4
> hj<-10/z0j
> Vj<-sqrt(gp*10*log(hj)^2/hj)
> Vj
[1] 6.019279

> ###===================12 June 2011======================###
> a<-0.0185
> k<-0.4
> g<-9.81
> z<-10
> c0<-3.7
> c1<--1.165
> j<-(30:0)
> z0<-2^-j
> y<-log(z/z0)
> V10<-sqrt((g*z)/(a*k^2))*y*exp(-y/2)
> gamma<-y*y*exp(-y)
> z0hat<-z*exp(-(c0+c1*log(gamma)))
> z<-19.5
> V10V19<-log(10/z0)/log(z/z0)
> V10V19hat<-log(10/z0hat)/log(z/z0hat)
> z<-4
> V10V4<-log(10/z0)/log(z/z0)
> V10V4hat<-log(10/z0hat)/log(z/z0hat)
> x<-cbind(j,z0*10^6,V10,V10V4,V10V19,z0hat*10^6,V10V4hat,V10V19hat)
> options(width=120)
> x
       j                       V10    V10V4    V10V19              V10V4hat V10V19hat
 [1,] 30 9.313226e-04   0.04057834 1.041310 0.9718984 7.659432e-04 1.040949 0.9721277
 [2,] 29 1.862645e-03   0.05566426 1.042643 0.9710542 1.599794e-03 1.042343 0.9712438
 [3,] 28 3.725290e-03   0.07628562 1.044064 0.9701576 3.333974e-03 1.043830 0.9703049
 [4,] 27 7.450581e-03   0.10443979 1.045584 0.9692037 6.931522e-03 1.045421 0.9693059
 [5,] 26 1.490116e-02   0.14282910 1.047212 0.9681868 1.437453e-02 1.047124 0.9682413
 [6,] 25 2.980232e-02   0.19510212 1.048960 0.9671005 2.972907e-02 1.048954 0.9671045
 [7,] 24 5.960464e-02   0.26617392 1.050843 0.9659374 6.130650e-02 1.050923 0.9658884
 [8,] 23 1.192093e-01   0.36264931 1.052877 0.9646890 1.260304e-01 1.053047 0.9645848
 [9,] 22 2.384186e-01   0.49337930 1.055080 0.9633457 2.582156e-01 1.055346 0.9631845
[10,] 21 4.768372e-01   0.67018878 1.057475 0.9618960 5.271209e-01 1.057839 0.9616768
[11,] 20 9.536743e-01   0.90882153 1.060088 0.9603270 1.071830e+00 1.060551 0.9600498
[12,] 19 1.907349e+00   1.23015789 1.062949 0.9586233 2.170100e+00 1.063512 0.9582897
[13,] 18 3.814697e+00   1.66176888 1.066096 0.9567666 4.373211e+00 1.066754 0.9563807
[14,] 17 7.629395e+00   2.23987641 1.069575 0.9547355 8.767846e+00 1.070318 0.9543047
[15,] 16 1.525879e+01   3.01178943 1.073440 0.9525041 1.747963e+01 1.074249 0.9520406
[16,] 15 3.051758e+01   4.03887411 1.077760 0.9500413 3.463039e+01 1.078604 0.9495643
[17,] 14 6.103516e+01   5.40008220 1.082621 0.9473091 6.813398e+01 1.083448 0.9468477
[18,] 13 1.220703e+02   7.19599077 1.088129 0.9442608 1.330123e+02 1.088862 0.9438586
[19,] 12 2.441406e+02   9.55317108 1.094423 0.9408382 2.574036e+02 1.094941 0.9405596
[20,] 11 4.882812e+02  12.62846666 1.101687 0.9369677 4.931940e+02 1.101800 0.9369081
[21,] 10 9.765625e+02  16.61235549 1.110161 0.9325553 9.342769e+02 1.109578 0.9328555
[22,]  9 1.953125e+03  21.72990356 1.120175 0.9274787 1.746689e+03 1.118440 0.9283479
[23,]  8 3.906250e+03  28.23673766 1.132193 0.9215757 3.215649e+03 1.128584 0.9233274
[24,]  7 7.812500e+03  36.40574759 1.146881 0.9146265 5.812954e+03 1.140235 0.9177356
[25,]  6 1.562500e+04  46.49752867 1.165241 0.9063261 1.027975e+04 1.153640 0.9115223
[26,]  5 3.125000e+04  58.70337614 1.188847 0.8962378 1.769521e+04 1.169034 0.9046622
[27,]  4 6.250000e+04  73.04316404 1.220321 0.8837143 2.944498e+04 1.186559 0.8971882
[28,]  3 1.250000e+05  89.19051418 1.264386 0.8677528 4.689358e+04 1.206085 0.8892542
[29,]  2 2.500000e+05 106.18254149 1.330482 0.8467124 7.040032e+04 1.226813 0.8812531
[30,]  1 5.000000e+05 121.94855216 1.440643 0.8177103 9.719915e+04 1.246494 0.8740279
[31,]  0 1.000000e+06 132.55750978 1.660964 0.7751730 1.180519e+05 1.260094 0.8692337
> x[c(16,20,24),]
      j                  V10    V10V4    V10V19            V10V4hat V10V19hat
[1,] 15   30.51758  4.038874 1.077760 0.9500413   34.63039 1.078604 0.9495643
[2,] 11  488.28125 12.628467 1.101687 0.9369677  493.19404 1.101800 0.9369081
[3,]  7 7812.50000 36.405748 1.146881 0.9146265 5812.95363 1.140235 0.9177356
> x[c(17,20,23),]
      j                  V10    V10V4    V10V19            V10V4hat V10V19hat
[1,] 14   61.03516  5.400082 1.082621 0.9473091   68.13398 1.083448 0.9468477
[2,] 11  488.28125 12.628467 1.101687 0.9369677  493.19404 1.101800 0.9369081
[3,]  8 3906.25000 28.236738 1.132193 0.9215757 3215.64943 1.128584 0.9233274

> z<-10
> y<-log(z/z0)
> gamma<-y^2 * exp(-y)
> V<-sqrt((g*z)/(a*k^2))*y*exp(-y/2)

> # NB: y and gamma depend only on y,
> # so the regression is independent of z, a, k, etc.

> abfit24<-lsfit(log(gamma[1:24]),y[1:24])
> abfit25<-lsfit(log(gamma[1:25]),y[1:25])
> abfit24$coef
 Intercept         X 
   3.71405 -1.163954
> abfit25$coef
 Intercept         X 
   3.63584 -1.170362

> # y-gamma-fit.ps
> plot(log(gamma), y)
> abline(a=3.7,b=-1.165,col=1,lty=2)
> abline(v=log(gamma[25]),col=2)

> # why not 1.164
> z0calc<-z*exp(-3.7 + 1.165 * log((a*k^2*V^2)/(g*z)))

> # z0-residuals.ps
> plot(log(z0),log(z0calc/z0))
> abline(h=0)
> abline(v=log(z0[25]),col=2)
